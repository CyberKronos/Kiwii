<ion-view view-title="{{ userData.handle || 'Profile' }}">
  <ion-nav-bar ng-controller="NavCtrl" class="bar-assertive">
    <ion-nav-buttons side="left">
      <a class="button button-icon button-clear ion-chevron-left"
         ng-click="goBack()"
         ng-if="showBackButton"></a>
    </ion-nav-buttons>
    <ion-nav-buttons side="right">
      <button class="button button-clear icon-white" ng-if="!showBackButton" ng-click="logOut()">
        Sign out
      </button>
    </ion-nav-buttons>
  </ion-nav-bar>

  <nav mfb-menu position="br" effect="zoomin" label="Actions"
       active-icon="ion-plus-round" resting-icon="ion-plus-round"
       toggling-method="click"
       class="mfb-has-tabs">
    <button mfb-button icon="ion-ios-list" label="Create List"
            ng-click="createList()"></button>
    <button mfb-button icon="ion-android-list" label="Create Card"
            ng-click="$state.go('tab.images')" ></button>
  </nav>

  <ion-content ng-controller="ProfileCtrl">

    <ion-refresher on-refresh="doRefresh()"></ion-refresher>

    <div class="profile-top-container">
      <div class="row" style="padding: 10px;">
        <div class="col col-25">
          <img class="profile-avatar" ng-src="{{userData.fbPicture || 'img/user_placeholder.png'}}">
        </div>
        <div class="col col-65">
          <p class="title text-strong-grey">
            <strong>{{ userData.firstname }} {{ userData.lastname }}</strong>
            <i ng-if="userData.verified" class="icon ion-checkmark-circled positive"></i>
          </p>
          <p class="text-light-grey" ng-if="userData.handle">@{{ userData.handle }}</p>
          <!-- <p class="text-light-grey">www.website.com</p> -->
        </div>
      </div>
      <div class="row" style="padding: 0 12px; border-bottom: #ddd 2px solid; border-top: #ddd 2px solid; background-color: #f5f5f5;">
        <div class="col col-25">
          <div class="title text-strong-grey"><strong>{{ userListCount || '0'}}</strong></div>
          <div class="text-light-grey">Lists</div>
        </div>
        <div class="col col-25">
          <div class="title text-strong-grey"><strong>{{ userCardsCount || '0'}}</strong></div>
          <div class="text-light-grey">Cards</div>
        </div>
        <div class="col col-25" ng-click="viewFollowers()">
          <div class="title text-strong-grey"><strong>{{ followerCount || '0'}}</strong></div>
          <div class="text-light-grey">Followers</div>
        </div>
        <div class="col col-25" ng-click="viewFollowing()">
          <div class="title text-strong-grey"><strong>{{ followingCount || '0'}}</strong></div>
          <div class="text-light-grey">Following</div>
        </div>
      </div>
    </div>

    <ti-segmented-control on-select="segmentChange($index)" style="width: 100%;">
      <ti-segmented-control-button class="button-assertive" style="border-radius: 0; max-height: 50px; line-height: 38px;" title="'Lists'" selected>
      </ti-segmented-control-button>
      <ti-segmented-control-button class="button-assertive" style="border-radius: 0; max-height: 50px; line-height: 38px;" title="'Cards'">
      </ti-segmented-control-button>
    </ti-segmented-control>

    <div ng-if="selectedIndex === 0">
      <ion-slide-box show-pager="false" class="dash-feature" ng-repeat="userList in userLists">
        <ion-slide darken-slider 
                   back-img="{{userList.attributes.thumbnailUrl || 'https://placehold.it/300x150/33F25A/000000'}}"
                   ng-click="listDetails(userList)">
          <div style="display: flex;
                      flex-direction: column;
                      justify-content: flex-end;
                      align-items: flex-start;
                      height: 100%;
                      color: white;
                      padding: 10px;">
            <p style="font-size: 2.0em; font-weight: bold;">{{userList.attributes.name}}</p>
            <p style="font-size: 1.2em">{{userList.attributes.category}}</p>
            <p style="font-size: 1.2em">2 Restaurants</p>
          </div>
        </ion-slide>
        <ion-slide back-img="https://placehold.it/300x150/FAFAFA/000000?text=Restaurant+1">
          <div class="restaurant-card-details" 
               style="position: absolute;
                      bottom: 0;
                      box-shadow: none;
                      color: white;
                      background-color: rgba(0,0,0,0.5);">
            <div class="row name">
              <div id="restaurant-name" style="font-weight: bold;">Name</div>
              <div>
                <i class="icon ion-star"></i>
                10/10
              </div>
            </div>
            <div class="status">
              Open till 10pm
            </div>
            <div class="footer">
              <div class="action">
                <div class="label">
                  Category · 200 Photos · 100 Reviews
                </div>
              </div>
              <div class="attribution">
                <img ng-src="./img/foursquare-logomark.png"/>
              </div>
            </div>
          </div>
        </ion-slide>
      </ion-slide-box>
    </div>

    <div ng-if="selectedIndex === 1">
      <div ng-if="!photos.length" class="text-centered">
        <div class="save-later-placeholder">
          <img src="img/restaurant_placeholder.gif">
        </div>
        <p>Start uploading cards!</p>
      </div>

      <div collection-repeat="card in userCards" style="padding:2px 1px;" class="col col-25">
        <a ng-click="photoDetails(card)">
          <div style="background-image:url({{card.photos[0].photo._url}});
                      background-repeat:no-repeat;
                      background-size:contain;
                      background-position:center;
                      width:100%;
                      height:0;
                      padding-top:100%">
          </div>
        </a>
      </div>
    </div>

  </ion-content>
</ion-view>